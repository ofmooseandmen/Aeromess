<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |</span><span>
</span><a name="line-2"></a><span class="hs-comment">-- Operations on Air Traffic Service (ATS) messages as defined in</span><span>
</span><a name="line-3"></a><span class="hs-comment">-- the ICAO 4444 edition 2016 standard.</span><span>
</span><a name="line-4"></a><span class="hs-comment">--</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- TODO: consider builder as in AerodromeReport.</span><span>
</span><a name="line-6"></a><span class="hs-comment">--</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- == / Relevant links /</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- - &lt;http://flightservicebureau.org/wp-content/uploads/2017/03/ICAO-Doc4444-Pans-Atm-16thEdition-2016-OPSGROUP.pdf ICAO 4444 Editon 2016&gt;</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- - &lt;http://wiki.flightgear.org/User:Johan_G/Standard_ICAO_ATS_messages_and_fields Standard ICAO ATS messages and fields&gt;</span><span>
</span><a name="line-10"></a><span class="hs-comment">--</span><span>
</span><a name="line-11"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Icao</span><span class="hs-operator">.</span><span class="hs-identifier">AtsMessage</span><span>
</span><a name="line-12"></a><span>    </span><span class="hs-special">(</span><span> </span><a href="Data.Icao.AtsMessage.html#AtsMessage"><span class="hs-identifier hs-type">AtsMessage</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-13"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Icao.AtsMessage.html#ArrivalContent"><span class="hs-identifier hs-type">ArrivalContent</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-14"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Icao.AtsMessage.html#DepartureContent"><span class="hs-identifier hs-type">DepartureContent</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-15"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Icao.AtsMessage.html#DelayContent"><span class="hs-identifier hs-type">DelayContent</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-16"></a><span>    </span><span class="hs-comment">-- re-exported modules</span><span>
</span><a name="line-17"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Icao</span><span class="hs-operator">.</span><span class="hs-identifier">Lang</span><span>
</span><a name="line-18"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Icao</span><span class="hs-operator">.</span><span class="hs-identifier">Location</span><span>
</span><a name="line-19"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Icao</span><span class="hs-operator">.</span><span class="hs-identifier">OtherInformation</span><span>
</span><a name="line-20"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Icao</span><span class="hs-operator">.</span><span class="hs-identifier">SupplementaryInformation</span><span>
</span><a name="line-21"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Icao</span><span class="hs-operator">.</span><span class="hs-identifier">Time</span><span>
</span><a name="line-22"></a><span>    </span><span class="hs-comment">-- re-exported data</span><span>
</span><a name="line-23"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Icao.F7.html#AircraftIdentification"><span class="hs-identifier hs-type">F7</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">AircraftIdentification</span></a><span>
</span><a name="line-24"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Icao.F7.html#SsrCode"><span class="hs-identifier hs-type">F7</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">SsrCode</span></a><span>
</span><a name="line-25"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Icao.F8.html#FlightRules"><span class="hs-identifier hs-type">F8</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">FlightRules</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Icao.F8.html#FlightType"><span class="hs-identifier hs-type">F8</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">FlightType</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Icao.F9.html#AircraftType"><span class="hs-identifier hs-type">F9</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">AircraftType</span></a><span>
</span><a name="line-28"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Icao.F9.html#WakeTurbulenceCategory"><span class="hs-identifier hs-type">F9</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">WakeTurbulenceCategory</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Icao.F10.html#ComNavAppCapabilityCode"><span class="hs-identifier hs-type">F10</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ComNavAppCapabilityCode</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Icao.F10.html#SurveillanceCapabilityCode"><span class="hs-identifier hs-type">F10</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">SurveillanceCapabilityCode</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span>    </span><span class="hs-comment">-- re-exported smart constructors</span><span>
</span><a name="line-32"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Icao.F7.html#mkAircraftIdentification"><span class="hs-identifier hs-var">F7</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mkAircraftIdentification</span></a><span>
</span><a name="line-33"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Icao.F7.html#mkSsrCode"><span class="hs-identifier hs-var">F7</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mkSsrCode</span></a><span>
</span><a name="line-34"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Icao.F9.html#mkAircraftType"><span class="hs-identifier hs-var">F9</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mkAircraftType</span></a><span>
</span><a name="line-35"></a><span>    </span><span class="hs-comment">-- * Parser</span><span>
</span><a name="line-36"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeromess.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span>
</span><a name="line-37"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Aeromess.Parser.html#Error"><span class="hs-identifier hs-type">Error</span></a><span class="hs-special">(</span><span class="hs-identifier">message</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">column</span><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Icao.AtsMessage.html#parse"><span class="hs-identifier hs-var">parse</span></a><span>
</span><a name="line-39"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Icao.AtsMessage.html#parser"><span class="hs-identifier hs-var">parser</span></a><span>
</span><a name="line-40"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Aeromess.Parser.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Aeromess</span><span class="hs-operator">.</span><span class="hs-identifier">Parser</span></a><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Data.Icao.F10.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Icao</span><span class="hs-operator">.</span><span class="hs-identifier">F10</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">F10</span><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Data.Icao.F13.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Icao</span><span class="hs-operator">.</span><span class="hs-identifier">F13</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">F13</span><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Data.Icao.F16.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Icao</span><span class="hs-operator">.</span><span class="hs-identifier">F16</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">F16</span><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Data.Icao.F17.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Icao</span><span class="hs-operator">.</span><span class="hs-identifier">F17</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">F17</span><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Data.Icao.F18.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Icao</span><span class="hs-operator">.</span><span class="hs-identifier">F18</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">F18</span><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Data.Icao.F3.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Icao</span><span class="hs-operator">.</span><span class="hs-identifier">F3</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">F3</span><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Data.Icao.F7.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Icao</span><span class="hs-operator">.</span><span class="hs-identifier">F7</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">F7</span><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Data.Icao.F8.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Icao</span><span class="hs-operator">.</span><span class="hs-identifier">F8</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">F8</span><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Data.Icao.F9.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Icao</span><span class="hs-operator">.</span><span class="hs-identifier">F9</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">F9</span><span>
</span><a name="line-52"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Icao.Lang.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Icao</span><span class="hs-operator">.</span><span class="hs-identifier">Lang</span></a><span>
</span><a name="line-53"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Icao.Location.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Icao</span><span class="hs-operator">.</span><span class="hs-identifier">Location</span></a><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Icao.OtherInformation.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Icao</span><span class="hs-operator">.</span><span class="hs-identifier">OtherInformation</span></a><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Icao.SupplementaryInformation.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Icao</span><span class="hs-operator">.</span><span class="hs-identifier">SupplementaryInformation</span></a><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Icao.Time.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Icao</span><span class="hs-operator">.</span><span class="hs-identifier">Time</span></a><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span class="hs-comment">-- | Arrival message content.</span><span>
</span><a name="line-60"></a><span class="hs-comment">-- An arrival message shall be transmitted:</span><span>
</span><a name="line-61"></a><span class="hs-comment">-- upon reception of an arrival report by the ATS unit serving the arrival aerodrome,</span><span>
</span><a name="line-62"></a><span class="hs-comment">-- or</span><span>
</span><a name="line-63"></a><span class="hs-comment">-- when a controlled flight which has experienced failure of two-way communication</span><span>
</span><a name="line-64"></a><span class="hs-comment">-- has landed, by the aerodrome control tower at the arrival aerodrome.</span><span>
</span><a name="line-65"></a><span class="hs-keyword">data</span><span> </span><a name="ArrivalContent"><a href="Data.Icao.AtsMessage.html#ArrivalContent"><span class="hs-identifier">ArrivalContent</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ArrivalContent"><a href="Data.Icao.AtsMessage.html#ArrivalContent"><span class="hs-identifier">ArrivalContent</span></a></a><span>
</span><a name="line-66"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="arrAircraftIndentification"><a href="Data.Icao.AtsMessage.html#arrAircraftIndentification"><span class="hs-identifier">arrAircraftIndentification</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Icao.F7.html#AircraftIdentification"><span class="hs-identifier hs-type">F7</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">AircraftIdentification</span></a><span> </span><span class="hs-comment">-- ^ aircraft identification.</span><span>
</span><a name="line-67"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="arrSsrCode"><a href="Data.Icao.AtsMessage.html#arrSsrCode"><span class="hs-identifier">arrSsrCode</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.Icao.F7.html#SsrCode"><span class="hs-identifier hs-type">F7</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">SsrCode</span></a><span> </span><span class="hs-comment">-- ^ SSR code.</span><span>
</span><a name="line-68"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="arrAdep"><a href="Data.Icao.AtsMessage.html#arrAdep"><span class="hs-identifier">arrAdep</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Icao.Location.html#Aerodrome"><span class="hs-identifier hs-type">Aerodrome</span></a><span> </span><span class="hs-comment">-- ^ aerodrome of departure.</span><span>
</span><a name="line-69"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="arrEobt"><a href="Data.Icao.AtsMessage.html#arrEobt"><span class="hs-identifier">arrEobt</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Icao.Time.html#Hhmm"><span class="hs-identifier hs-type">Hhmm</span></a><span> </span><span class="hs-comment">-- ^ estimated off-block time.</span><span>
</span><a name="line-70"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="arrAdes"><a href="Data.Icao.AtsMessage.html#arrAdes"><span class="hs-identifier">arrAdes</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.Icao.Location.html#Aerodrome"><span class="hs-identifier hs-type">Aerodrome</span></a><span> </span><span class="hs-comment">-- ^ aerodrome of arrival, only in case of a diversionary landing.</span><span>
</span><a name="line-71"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="arrAdar"><a href="Data.Icao.AtsMessage.html#arrAdar"><span class="hs-identifier">arrAdar</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Icao.Location.html#Aerodrome"><span class="hs-identifier hs-type">Aerodrome</span></a><span> </span><span class="hs-comment">-- ^actual aerodrome of arrival.</span><span>
</span><a name="line-72"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="arrAta"><a href="Data.Icao.AtsMessage.html#arrAta"><span class="hs-identifier">arrAta</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Icao.Time.html#Hhmm"><span class="hs-identifier hs-type">Hhmm</span></a><span> </span><span class="hs-comment">-- ^ actual time of arrival.</span><span>
</span><a name="line-73"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="arrAdarName"><a href="Data.Icao.AtsMessage.html#arrAdarName"><span class="hs-identifier">arrAdarName</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.Icao.Lang.html#FreeText"><span class="hs-identifier hs-type">FreeText</span></a><span> </span><span class="hs-comment">-- ^ name of arrival aerodrome, if 'adar' is 'ZZZZ'.</span><span>
</span><a name="line-74"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span class="hs-comment">-- | Departure message content.</span><span>
</span><a name="line-77"></a><span class="hs-comment">-- A departure message shall be transmitted by the ATS unit serving the</span><span>
</span><a name="line-78"></a><span class="hs-comment">-- departure aerodrome to all recipients of basic flight plan data.</span><span>
</span><a name="line-79"></a><span class="hs-keyword">data</span><span> </span><a name="DepartureContent"><a href="Data.Icao.AtsMessage.html#DepartureContent"><span class="hs-identifier">DepartureContent</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="DepartureContent"><a href="Data.Icao.AtsMessage.html#DepartureContent"><span class="hs-identifier">DepartureContent</span></a></a><span>
</span><a name="line-80"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="depAircraftIndentification"><a href="Data.Icao.AtsMessage.html#depAircraftIndentification"><span class="hs-identifier">depAircraftIndentification</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Icao.F7.html#AircraftIdentification"><span class="hs-identifier hs-type">F7</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">AircraftIdentification</span></a><span> </span><span class="hs-comment">-- ^ aircraft identification.</span><span>
</span><a name="line-81"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="depSsrCode"><a href="Data.Icao.AtsMessage.html#depSsrCode"><span class="hs-identifier">depSsrCode</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.Icao.F7.html#SsrCode"><span class="hs-identifier hs-type">F7</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">SsrCode</span></a><span> </span><span class="hs-comment">-- ^ SSR code.</span><span>
</span><a name="line-82"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="depAdep"><a href="Data.Icao.AtsMessage.html#depAdep"><span class="hs-identifier">depAdep</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Icao.Location.html#Aerodrome"><span class="hs-identifier hs-type">Aerodrome</span></a><span> </span><span class="hs-comment">-- ^ aerodrome of departure.</span><span>
</span><a name="line-83"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="depAtd"><a href="Data.Icao.AtsMessage.html#depAtd"><span class="hs-identifier">depAtd</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Icao.Time.html#Hhmm"><span class="hs-identifier hs-type">Hhmm</span></a><span> </span><span class="hs-comment">-- ^ actual time of departure.</span><span>
</span><a name="line-84"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="depAdes"><a href="Data.Icao.AtsMessage.html#depAdes"><span class="hs-identifier">depAdes</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Icao.Location.html#Aerodrome"><span class="hs-identifier hs-type">Aerodrome</span></a><span> </span><span class="hs-comment">-- ^ aerodrome of arrival.</span><span>
</span><a name="line-85"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="depOtherInformation"><a href="Data.Icao.AtsMessage.html#depOtherInformation"><span class="hs-identifier">depOtherInformation</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Icao.OtherInformation.html#OtherInformation"><span class="hs-identifier hs-type">OtherInformation</span></a><span> </span><span class="hs-comment">-- ^ other information.</span><span>
</span><a name="line-86"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-comment">-- | Delay message content.</span><span>
</span><a name="line-89"></a><span class="hs-comment">-- A delay message shall be transmitted when the departure of an aircraft, for which basic flight plan data has been sent,</span><span>
</span><a name="line-90"></a><span class="hs-comment">-- is delayed by more than 30 minutes after the estimated off-block time contained in the basic flight plan data.</span><span>
</span><a name="line-91"></a><span class="hs-keyword">data</span><span> </span><a name="DelayContent"><a href="Data.Icao.AtsMessage.html#DelayContent"><span class="hs-identifier">DelayContent</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="DelayContent"><a href="Data.Icao.AtsMessage.html#DelayContent"><span class="hs-identifier">DelayContent</span></a></a><span>
</span><a name="line-92"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="dlaAircraftIndentification"><a href="Data.Icao.AtsMessage.html#dlaAircraftIndentification"><span class="hs-identifier">dlaAircraftIndentification</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Icao.F7.html#AircraftIdentification"><span class="hs-identifier hs-type">F7</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">AircraftIdentification</span></a><span> </span><span class="hs-comment">-- ^ aircraft identification.</span><span>
</span><a name="line-93"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="dlaSsrCode"><a href="Data.Icao.AtsMessage.html#dlaSsrCode"><span class="hs-identifier">dlaSsrCode</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.Icao.F7.html#SsrCode"><span class="hs-identifier hs-type">F7</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">SsrCode</span></a><span> </span><span class="hs-comment">-- ^ SSR code.</span><span>
</span><a name="line-94"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="dlaAdep"><a href="Data.Icao.AtsMessage.html#dlaAdep"><span class="hs-identifier">dlaAdep</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Icao.Location.html#Aerodrome"><span class="hs-identifier hs-type">Aerodrome</span></a><span> </span><span class="hs-comment">-- ^ aerodrome of departure.</span><span>
</span><a name="line-95"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="dlaEobt"><a href="Data.Icao.AtsMessage.html#dlaEobt"><span class="hs-identifier">dlaEobt</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Icao.Time.html#Hhmm"><span class="hs-identifier hs-type">Hhmm</span></a><span> </span><span class="hs-comment">-- ^ revised estimated off-block time.</span><span>
</span><a name="line-96"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="dlaAdes"><a href="Data.Icao.AtsMessage.html#dlaAdes"><span class="hs-identifier">dlaAdes</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Icao.Location.html#Aerodrome"><span class="hs-identifier hs-type">Aerodrome</span></a><span> </span><span class="hs-comment">-- ^ aerodrome of arrival.</span><span>
</span><a name="line-97"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="dlaOtherInformation"><a href="Data.Icao.AtsMessage.html#dlaOtherInformation"><span class="hs-identifier">dlaOtherInformation</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Icao.OtherInformation.html#OtherInformation"><span class="hs-identifier hs-type">OtherInformation</span></a><span> </span><span class="hs-comment">-- ^ other information.</span><span>
</span><a name="line-98"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span class="hs-comment">-- | ICAO 4444 ATS message.</span><span>
</span><a name="line-101"></a><span class="hs-keyword">data</span><span> </span><a name="AtsMessage"><a href="Data.Icao.AtsMessage.html#AtsMessage"><span class="hs-identifier">AtsMessage</span></a></a><span>
</span><a name="line-102"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a name="Arr"><a href="Data.Icao.AtsMessage.html#Arr"><span class="hs-identifier">Arr</span></a></a><span> </span><a href="Data.Icao.AtsMessage.html#ArrivalContent"><span class="hs-identifier hs-type">ArrivalContent</span></a><span> </span><span class="hs-comment">-- ^ Arrival message.</span><span>
</span><a name="line-103"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Dep"><a href="Data.Icao.AtsMessage.html#Dep"><span class="hs-identifier">Dep</span></a></a><span> </span><a href="Data.Icao.AtsMessage.html#DepartureContent"><span class="hs-identifier hs-type">DepartureContent</span></a><span> </span><span class="hs-comment">-- ^ Departure message.</span><span>
</span><a name="line-104"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Dla"><a href="Data.Icao.AtsMessage.html#Dla"><span class="hs-identifier">Dla</span></a></a><span> </span><a href="Data.Icao.AtsMessage.html#DelayContent"><span class="hs-identifier hs-type">DelayContent</span></a><span> </span><span class="hs-comment">-- ^ Delay message.</span><span>
</span><a name="line-105"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-comment">-- | 'ArrivalMessage' parser.</span><span>
</span><a name="line-108"></a><span class="hs-identifier">arrParser</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeromess.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span> </span><a href="Data.Icao.AtsMessage.html#AtsMessage"><span class="hs-identifier hs-type">AtsMessage</span></a><span>
</span><a name="line-109"></a><a name="arrParser"><a href="Data.Icao.AtsMessage.html#arrParser"><span class="hs-identifier">arrParser</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-110"></a><span>    </span><a name="local-1627442706"><a href="#local-1627442706"><span class="hs-identifier">f7</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Icao.F7.html#parser"><span class="hs-identifier hs-var">F7</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">parser</span></a><span>
</span><a name="line-111"></a><span>    </span><a name="local-1627442707"><a href="#local-1627442707"><span class="hs-identifier">f13</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Icao.F13.html#parser"><span class="hs-identifier hs-var">F13</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">parser</span></a><span>
</span><a name="line-112"></a><span>    </span><a name="local-1627442708"><a href="#local-1627442708"><span class="hs-identifier">ades</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Aeromess.Parser.html#optional"><span class="hs-identifier hs-var">optional</span></a><span> </span><span class="hs-special">(</span><a href="Data.Aeromess.Parser.html#try"><span class="hs-identifier hs-var">try</span></a><span> </span><a href="Data.Icao.F16.html#adesParser"><span class="hs-identifier hs-var">F16</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">adesParser</span></a><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span>    </span><a name="local-1627442709"><a href="#local-1627442709"><span class="hs-identifier">f17</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Icao.F17.html#parser"><span class="hs-identifier hs-var">F17</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">parser</span></a><span>
</span><a name="line-114"></a><span>    </span><span class="hs-identifier hs-var">return</span><span>
</span><a name="line-115"></a><span>        </span><span class="hs-special">(</span><a href="Data.Icao.AtsMessage.html#Arr"><span class="hs-identifier hs-var">Arr</span></a><span>
</span><a name="line-116"></a><span>             </span><span class="hs-special">(</span><a href="Data.Icao.AtsMessage.html#ArrivalContent"><span class="hs-identifier hs-var">ArrivalContent</span></a><span>
</span><a name="line-117"></a><span>                  </span><span class="hs-special">(</span><span class="hs-identifier">F7</span><span class="hs-operator">.</span><span class="hs-identifier">aircraftIdentification</span><span> </span><a href="#local-1627442706"><span class="hs-identifier hs-var">f7</span></a><span class="hs-special">)</span><span>
</span><a name="line-118"></a><span>                  </span><span class="hs-special">(</span><span class="hs-identifier">F7</span><span class="hs-operator">.</span><span class="hs-identifier">ssrCode</span><span> </span><a href="#local-1627442706"><span class="hs-identifier hs-var">f7</span></a><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span>                  </span><span class="hs-special">(</span><span class="hs-identifier">F13</span><span class="hs-operator">.</span><span class="hs-identifier">adep</span><span> </span><a href="#local-1627442707"><span class="hs-identifier hs-var">f13</span></a><span class="hs-special">)</span><span>
</span><a name="line-120"></a><span>                  </span><span class="hs-special">(</span><span class="hs-identifier">F13</span><span class="hs-operator">.</span><span class="hs-identifier">time</span><span> </span><a href="#local-1627442707"><span class="hs-identifier hs-var">f13</span></a><span class="hs-special">)</span><span>
</span><a name="line-121"></a><span>                  </span><a href="#local-1627442708"><span class="hs-identifier hs-var">ades</span></a><span>
</span><a name="line-122"></a><span>                  </span><span class="hs-special">(</span><span class="hs-identifier">F17</span><span class="hs-operator">.</span><span class="hs-identifier">adar</span><span> </span><a href="#local-1627442709"><span class="hs-identifier hs-var">f17</span></a><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>                  </span><span class="hs-special">(</span><span class="hs-identifier">F17</span><span class="hs-operator">.</span><span class="hs-identifier">ata</span><span> </span><a href="#local-1627442709"><span class="hs-identifier hs-var">f17</span></a><span class="hs-special">)</span><span>
</span><a name="line-124"></a><span>                  </span><span class="hs-special">(</span><span class="hs-identifier">F17</span><span class="hs-operator">.</span><span class="hs-identifier">adarName</span><span> </span><a href="#local-1627442709"><span class="hs-identifier hs-var">f17</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-comment">-- | common parser for DEP and DLA messages.</span><span>
</span><a name="line-127"></a><span class="hs-identifier">depParser'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeromess.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span> </span><span class="hs-special">(</span><a href="Data.Icao.F7.html#AircraftIdentification"><span class="hs-identifier hs-type">F7</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">AircraftIdentification</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.Icao.F7.html#SsrCode"><span class="hs-identifier hs-type">F7</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">SsrCode</span></a><span class="hs-special">,</span><span> </span><a href="Data.Icao.Location.html#Aerodrome"><span class="hs-identifier hs-type">Aerodrome</span></a><span class="hs-special">,</span><span> </span><a href="Data.Icao.Time.html#Hhmm"><span class="hs-identifier hs-type">Hhmm</span></a><span class="hs-special">,</span><span> </span><a href="Data.Icao.Location.html#Aerodrome"><span class="hs-identifier hs-type">Aerodrome</span></a><span class="hs-special">,</span><span> </span><a href="Data.Icao.OtherInformation.html#OtherInformation"><span class="hs-identifier hs-type">OtherInformation</span></a><span class="hs-special">)</span><span>
</span><a name="line-128"></a><a name="depParser%27"><a href="Data.Icao.AtsMessage.html#depParser%27"><span class="hs-identifier">depParser'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-129"></a><span>    </span><a name="local-1627442710"><a href="#local-1627442710"><span class="hs-identifier">f7</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Icao.F7.html#parser"><span class="hs-identifier hs-var">F7</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">parser</span></a><span>
</span><a name="line-130"></a><span>    </span><a name="local-1627442711"><a href="#local-1627442711"><span class="hs-identifier">f13</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Icao.F13.html#parser"><span class="hs-identifier hs-var">F13</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">parser</span></a><span>
</span><a name="line-131"></a><span>    </span><a name="local-1627442712"><a href="#local-1627442712"><span class="hs-identifier">f16Ades</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Icao.F16.html#adesParser"><span class="hs-identifier hs-var">F16</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">adesParser</span></a><span>
</span><a name="line-132"></a><span>    </span><a name="local-1627442713"><a href="#local-1627442713"><span class="hs-identifier">f18</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Icao.F18.html#parser"><span class="hs-identifier hs-var">F18</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">parser</span></a><span>
</span><a name="line-133"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">F7</span><span class="hs-operator">.</span><span class="hs-identifier">aircraftIdentification</span><span> </span><a href="#local-1627442710"><span class="hs-identifier hs-var">f7</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">F7</span><span class="hs-operator">.</span><span class="hs-identifier">ssrCode</span><span> </span><a href="#local-1627442710"><span class="hs-identifier hs-var">f7</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">F13</span><span class="hs-operator">.</span><span class="hs-identifier">adep</span><span> </span><a href="#local-1627442711"><span class="hs-identifier hs-var">f13</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">F13</span><span class="hs-operator">.</span><span class="hs-identifier">time</span><span> </span><a href="#local-1627442711"><span class="hs-identifier hs-var">f13</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627442712"><span class="hs-identifier hs-var">f16Ades</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627442713"><span class="hs-identifier hs-var">f18</span></a><span class="hs-special">)</span><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-comment">-- | 'DepartureMessage' parser.</span><span>
</span><a name="line-136"></a><span class="hs-identifier">depParser</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeromess.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span> </span><a href="Data.Icao.AtsMessage.html#AtsMessage"><span class="hs-identifier hs-type">AtsMessage</span></a><span>
</span><a name="line-137"></a><a name="depParser"><a href="Data.Icao.AtsMessage.html#depParser"><span class="hs-identifier">depParser</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-138"></a><span>    </span><a name="local-1627442714"><a href="#local-1627442714"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Icao.AtsMessage.html#depParser%27"><span class="hs-identifier hs-var">depParser'</span></a><span>
</span><a name="line-139"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1627442715"><a href="#local-1627442715"><span class="hs-identifier">ai</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627442716"><a href="#local-1627442716"><span class="hs-identifier">sc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627442717"><a href="#local-1627442717"><span class="hs-identifier">d</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627442718"><a href="#local-1627442718"><span class="hs-identifier">t</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627442719"><a href="#local-1627442719"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627442720"><a href="#local-1627442720"><span class="hs-identifier">o</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627442714"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-140"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Data.Icao.AtsMessage.html#Dep"><span class="hs-identifier hs-var">Dep</span></a><span> </span><span class="hs-special">(</span><a href="Data.Icao.AtsMessage.html#DepartureContent"><span class="hs-identifier hs-var">DepartureContent</span></a><span> </span><a href="#local-1627442715"><span class="hs-identifier hs-var">ai</span></a><span> </span><a href="#local-1627442716"><span class="hs-identifier hs-var">sc</span></a><span> </span><a href="#local-1627442717"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-1627442718"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-1627442719"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-1627442720"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-141"></a><span>
</span><a name="line-142"></a><span class="hs-comment">-- | 'DelayMessage' parser.</span><span>
</span><a name="line-143"></a><span class="hs-identifier">dlaParser</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeromess.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span> </span><a href="Data.Icao.AtsMessage.html#AtsMessage"><span class="hs-identifier hs-type">AtsMessage</span></a><span>
</span><a name="line-144"></a><a name="dlaParser"><a href="Data.Icao.AtsMessage.html#dlaParser"><span class="hs-identifier">dlaParser</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-145"></a><span>    </span><a name="local-1627442721"><a href="#local-1627442721"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Icao.AtsMessage.html#depParser%27"><span class="hs-identifier hs-var">depParser'</span></a><span>
</span><a name="line-146"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1627442722"><a href="#local-1627442722"><span class="hs-identifier">ai</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627442723"><a href="#local-1627442723"><span class="hs-identifier">sc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627442724"><a href="#local-1627442724"><span class="hs-identifier">d</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627442725"><a href="#local-1627442725"><span class="hs-identifier">t</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627442726"><a href="#local-1627442726"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627442727"><a href="#local-1627442727"><span class="hs-identifier">o</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627442721"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-147"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Data.Icao.AtsMessage.html#Dla"><span class="hs-identifier hs-var">Dla</span></a><span> </span><span class="hs-special">(</span><a href="Data.Icao.AtsMessage.html#DelayContent"><span class="hs-identifier hs-var">DelayContent</span></a><span> </span><a href="#local-1627442722"><span class="hs-identifier hs-var">ai</span></a><span> </span><a href="#local-1627442723"><span class="hs-identifier hs-var">sc</span></a><span> </span><a href="#local-1627442724"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-1627442725"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-1627442726"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-1627442727"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span class="hs-comment">-- | ATS message content parser - i.e. everything between '(' and ')'</span><span>
</span><a name="line-150"></a><span class="hs-identifier">contentParser</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeromess.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span> </span><a href="Data.Icao.AtsMessage.html#AtsMessage"><span class="hs-identifier hs-type">AtsMessage</span></a><span>
</span><a name="line-151"></a><a name="contentParser"><a href="Data.Icao.AtsMessage.html#contentParser"><span class="hs-identifier">contentParser</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-152"></a><span>    </span><a name="local-1627442728"><a href="#local-1627442728"><span class="hs-identifier">f3</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Icao.F3.html#parser"><span class="hs-identifier hs-var">F3</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">parser</span></a><span>
</span><a name="line-153"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627442728"><span class="hs-identifier hs-var">f3</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-154"></a><span>        </span><span class="hs-string">&quot;ARR&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Icao.AtsMessage.html#arrParser"><span class="hs-identifier hs-var">arrParser</span></a><span>
</span><a name="line-155"></a><span>        </span><span class="hs-string">&quot;DEP&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Icao.AtsMessage.html#depParser"><span class="hs-identifier hs-var">depParser</span></a><span>
</span><a name="line-156"></a><span>        </span><span class="hs-string">&quot;DLA&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Icao.AtsMessage.html#dlaParser"><span class="hs-identifier hs-var">dlaParser</span></a><span>
</span><a name="line-157"></a><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Aeromess.Parser.html#unexpected"><span class="hs-identifier hs-var">unexpected</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;unexpected message=&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-1627442728"><span class="hs-identifier hs-var">f3</span></a><span class="hs-special">)</span><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span class="hs-comment">-- | 'AtsMessage' parser.</span><span>
</span><a name="line-160"></a><span class="hs-identifier">parser</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Aeromess.Parser.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span> </span><a href="Data.Icao.AtsMessage.html#AtsMessage"><span class="hs-identifier hs-type">AtsMessage</span></a><span>
</span><a name="line-161"></a><a name="parser"><a href="Data.Icao.AtsMessage.html#parser"><span class="hs-identifier">parser</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeromess.Parser.html#between"><span class="hs-identifier hs-var">between</span></a><span> </span><span class="hs-special">(</span><a href="Data.Aeromess.Parser.html#char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'('</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Aeromess.Parser.html#char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">')'</span><span class="hs-special">)</span><span> </span><a href="Data.Icao.AtsMessage.html#contentParser"><span class="hs-identifier hs-var">contentParser</span></a><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-comment">-- | Parses the given textual representation of an 'AtsMessage'.</span><span>
</span><a name="line-164"></a><span class="hs-comment">-- return either an 'Error' ('Left') or the parsed 'AtsMessage' ('Right').</span><span>
</span><a name="line-165"></a><span class="hs-identifier">parse</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="Data.Aeromess.Parser.html#Error"><span class="hs-identifier hs-type">Error</span></a><span> </span><a href="Data.Icao.AtsMessage.html#AtsMessage"><span class="hs-identifier hs-type">AtsMessage</span></a><span>
</span><a name="line-166"></a><a name="parse"><a href="Data.Icao.AtsMessage.html#parse"><span class="hs-identifier">parse</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Aeromess.Parser.html#runParser"><span class="hs-identifier hs-var">runParser</span></a><span> </span><a href="Data.Icao.AtsMessage.html#parser"><span class="hs-identifier hs-var">parser</span></a><span>
</span><a name="line-167"></a></pre></body></html>